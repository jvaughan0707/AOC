import re

rawInput = '''?.?#?#??#?.?#????? 4,2,5
?##??.#??#.???.# 4,4,2,1
#?#?.##???.?.? 4,2,1,1
...?#??#?#????#.. 10,1
?????#?#.??????????? 1,6,1,1,1,4
???????##???#???#??? 10,1,5
.?#??????.#.?#? 7,1,3
..#..??#???#???#?#?# 1,1,11,1
.??##?.??#?#?#?..? 5,7
?#???#?#??#???##?.? 2,9,4
.?#.?#?###????#???? 1,11,1
?..?#.??##??#??.? 2,9
??##.?#?????? 4,5,1
?.???#??#?#?#? 9,1
#??#.?????####. 4,9
???#????#?.??#? 9,2
#????.??#????? 1,1,1,7
?#??.##?###?##?. 3,6,2
??????#..????##??? 1,1,1,1,5
.?????#??#?????# 1,1,10
.????.#?#??#???. 2,9
#??.#??.?#.. 2,1,1
?#?#?????..#??.??? 6,1,1,1,1
???#?#?#?. 1,3,1
#?##??..??#?????#??. 5,8
..##??##??#????? 2,10
.?????#????????? 7,3
.???#?#?.???#?#.?.#? 7,1,1,1,1,1
.????.??#. 3,3
??????#???#??? 1,8
?.?#???#???.?.??## 1,1,5,1,4
?.#????.?????#?#? 1,2,1,1,6
.?????#?##?#?..???? 1,8,1,1
#????.???#?#?.? 2,2,1,2
#.?#??#??.?.? 1,2,2,1
????.???????? 2,2,1,2
?#?.??????#?#?.?# 1,9,2
?#????????? 2,4
??.?.###?#?#????. 1,1,8,1
.?????#??.#????.. 4,4
??#????#...#? 2,1,1,1
??.???#???.??#??. 1,3,1,1,3
.?###????#.#? 7,1,2
???#???.#.#?#??#?? 1,1,1,7
.###?..??#? 3,1,2
?.?#?#??????. 5,1,1
#??#??.?##??# 1,2,5
.??????????. 1,4,2
?.?.????????? 1,4,1
???.??###????? 1,6,1
????#####?##??# 12,1
.???.??????? 1,1
?.??.??????? 2,1,1,1
????#?###? 3,1,3
###?##.?.???##?..??? 6,5
???????.#? 1,1,1
???.#???#.#?#????.? 2,2,2,3,3,1
?.??#????.?.??. 1,5,1,2
?#??.?##??##??##?.. 3,11
##??.?#??.?? 2,1,1,1
#?????###?#?????#? 1,1,12
.??#.??#??.???? 1,1,4,1,1
?#??#.?????.???. 4,1
???#????.#?..? 4,2
?.?#?.??#?. 3,2
.###??#???#.?##?? 10,2
.???????.??? 3,2
.?????????? 1,1,2
.##??.??#?.?.#?#.?. 2,1,2,1,3,1
?????.?.?????##?. 2,1,3,4
???#?#???#?#??? 1,2,2,1,4
##?????#???##.?#?? 13,3
.#?????#?##??????? 1,7,1,1
?.?#???..??.?#??? 1,2,5
????.???.#?. 1,1
?#?##??#.#? 4,2,1
.#?#?#???#?.????#?? 10,2
???##????#???#????#? 4,7,1
???.#????#?#??????.. 1,1,10
#?#???#?.#??.??? 8,2,1
??#??????? 1,2,4
?.??#????#.? 1,5,1,1
??????#???#????? 2,9
#????????#???.?. 1,2,2,3,1
?#?#???????.?????## 8,1,5
????.????###?????# 1,9,1
??.?.??#??#.. 2,1
?#???.???.?#????. 2,1,2,3,1
????????#??#??????? 1,6,1,3
?#???#?#??. 2,1,1
??.?.#???? 1,3
.??#?#??????.#???? 1,1,3,3,5
??.?????.#????? 2,2,1,2,3
??..#..????.???.??# 1,1,4,1,1,1
???.?.???. 1,1,1
.??#???.?. 2,1,1
?##??#?#?#...?.? 9,1
.?#.?.???#?##. 1,7
?.#??????? 2,1
##?.?????##?###. 3,2,1,6
???..?#### 1,4
#?#?#.?#?.?????##?. 5,1,7
??.#??#???#?#???. 1,11,1
#.??.????#.? 1,1,1,1
??#????????##?? 2,2,1,4
??#?#????##?####?? 5,2,8
...?.?##????????. 1,5
????#.???.#. 1,2,1
.????.#????.?.??# 3,3,1,2
?????#.##??. 1,2,3
.#.??????##??.#???.? 1,6,1,4
??.??#.?????????. 3,2
??????.??? 1,1,3
.?????????????????? 6,1
.?#?#??#????#???? 4,7
??.???#?..? 2,3
??#????#??.??.?? 4,1,1,1,1
?.###???#?????? 1,7,2
???.??????#?#? 1,4,1,1
??.??###?##??#??? 1,5,8
.????..??#??? 1,1,2,1
?###?#???...?#?... 7,1
?.#?#?#???????#?#??. 7,7
#??##.?????. 1,3,3,1
#?#???#?#. 7,1
?????????.? 3,1
?#?#??.???????????.? 6,7,1,1
..???#????#? 3,1,1
?????????##?#?#? 1,8,1,2
????????###?? 1,1,6
?#.???????.. 2,1,3
.#.?????###???????# 1,2,9,1
?.??#?#.?.??#. 1,3,1,1
???#.???####? 1,1,6
??.#?#?????????#??? 1,3,1,1,8
?????????.???????? 1,4,1,1,1,1
.#?#.???#?#?.#????? 3,1,1,2,1,1
?????.#?.? 1,1,1
?????#?????? 6,1
??.?????#..?????# 1,1,3,2,1
.??#??????#?#????## 5,3,1,4
.?##?????? 5,2
???#??#?.?? 3,1,1
??##?.?#????.#?#? 4,4,1,4
????.????? 3,1,1
?#?#??????#??.#?? 8,1,1,1,1
#??????#???###?#? 3,12
?#??#???#? 1,2,3
##??????#????. 5,1
????????...???... 2,3
#.???????#????. 1,4,2
????.????. 2,2
??????###????????.?? 10,1,1,2
?.??????.?.??. 1,3
?#?##?#??.??##??##?? 8,9
??????..?#?### 3,1,5
.#...??#???? 1,6
#?????#??#?##? 4,1,5
#?#..??.#??#.?? 1,1,1,4,1
??##.??.??#..?????# 2,1,2,1,1,1
??#.##?#?###??.?#?#? 2,10,5
.?????###?? 1,5
.?????#???#???#???.? 10,2,1
?#??#?#?#?. 1,6
?##?????#???????? 3,1,2,2,1
?.#??#?#???? 1,4,1
?.#.?#???# 1,1,5
#???..?.#????? 2,1,1,3
???#?.??.? 4,1
.#?###.?????? 5,4
????#?#.?..##??? 5,5
.????##?.##?#?#.. 6,6
???????.????? 1,1,4
.?..??#??#?????#??? 7,4
?##???#?#???.##??? 2,4,2
???#??????????#?#? 1,1,1,1,2,4
????#?.?????#??? 1,2,6
??#??#????? 1,7
..?#?#??????.????## 5,3,6
???#?..#???####.# 2,1,1,6,1
?..???#??.#.??? 4,1,1,3
??.????##?.?.#?# 1,6,1,1,1
.???????.#??.?????.? 1,1,2,3,5,1
?##?#??????#????### 6,2,5
.??#?##????.#. 1,4,2,1
.??.#????.? 1,2
?.????????# 3,2
#???.#?.??.# 3,1,1,1
?#?????#???##??#?.? 16,1
#?.??##??.?.????#?#? 1,4,1,6
.??#?.??..?#? 3,2,3
..???.?????#??#.. 1,4
.?#???#???.#?????? 1,1,2,1,3,2
???.???#?##????? 1,8,1
??#?#??..???. 5,1
?#??#??#???.??? 6,3,2
?#??.????#???#?????? 2,1,12,1
??#.???????..???#??? 1,2,4,2,1,1
.??.?#?..???????. 3,3,2
?????#.??#??#?#..?. 1,1,1,6,1
??????#???#. 1,1,1,3
?..????????? 1,1
??.?..#.#.?#????#??? 1,1,1,1,8
?#?#?#????? 4,2,2
????#????#??.???. 11,1
???##.??#?# 4,3
??????...???? 1,1,1,2
????.#?.?.?.? 3,2
????.#??.?#? 1,1,1,1
??????.??..???? 2,1,1,2
?.?.#.?.????#?? 1,1,1,6
?#.?????..#.#?. 2,2,2,1,2
.?????#???.????.## 1,5,1,1,2
?##????.??.???? 4,1,1,3
?.?####???.???..# 8,1,1
?.?#???????#?#?# 1,2,2,7
.????#???. 5,1
.??#????..????. 3,1
?????.#?.?????????? 4,2,7,1
?..??#??#.???#??#?? 1,1,1,1,1,4
.#?###??????.???? 10,1
#?????#.#?? 3,3,2
??#??#??????##?? 7,5
???#?????.??? 4,2
?.##.?#?.?##.? 2,1,3,1
????###???#?. 8,2
.?#??##?????#???.? 6,2,1,1
???.????.#? 2,1,1
??#??#??#???#?? 6,1,1
?##?#??.?? 6,1
#?????????#?????#?? 5,8,1
.????????#?#??#???? 1,1,12,1
????#?????.#? 9,1
.?????#..?? 2,3
???#.????. 1,1,1
??????#?##???.. 1,5
????.?????? 1,5
???.?????. 2,4
?#???#.???.??? 6,2,1
???#??#??#???????? 1,6,4
.??#.?#??.???????# 3,4,3,3
?.??????.????? 5,3
??????###?#?.???? 2,1,6,4
?##?#???####????##? 2,1,12
.?#????????..?#?#?.# 3,3,4,1
??..??.?..?. 1,1,1,1
??.#??#?#??#???????# 1,1,9,2,1
??#?##?##..# 7,1
?????.????? 4,1,2
??##?##?#???.?##??.# 10,1,4,1
?##.#??#..??????##? 3,2,1,2,3
???.#.?#??.??? 1,1,3,1
???###.??? 4,1
?#?????.?#????##. 5,1,1,1,2
.?#?..????#?? 2,1,2
#??#??#??#.???#??.?? 4,4,1,2,1,1
??##?#??#?#???#? 3,6,1,2
#????.??.? 1,1,1
?##?###???????#???? 12,1,1
..??.??#?###? 1,7
??...???####?? 2,7
?#??????...#??#??# 3,1,1,1,1,2
.?????.??????? 1,5
?.#?.#????#?#?#? 1,1,1,5
#?##???#?????#.# 1,3,7,1
?#.##???.?.#?#. 1,3,1,3
?#???#????.??#??? 7,1,2,2
????#?##????#??#??? 1,5,2,2,2
???#??????#?#???#?.? 1,1,4,8,1
..?#?????.#???.? 6,3,1
??##?#?.#???.?.# 6,2,1,1
?????????#???..??? 1,4,2,1,1,1
?????##?#?. 1,2,4
?????#??#????? 1,4,1,1
??????.####.##???# 1,1,1,4,6
????#????? 5,1
.?.?????.#? 1,2,2
?????????##????. 2,9
.?????.??.???.?#?? 1,1,3
??#????#..?.?.? 3,2,1,1,1
??.?.?##..?..##..? 3,2
??????????.#???? 3,1,2,1,1
.??#.??#??.?#?.???? 1,4,3,3
??#??..#??. 3,1
??#??..?#. 3,1
#????#?.#?????##??? 1,1,2,9
??#?.????. 4,3
?????#???#?.?? 9,2
?.#???.????#. 2,1,3
??..#?????????#??. 1,9,2
???##????.?. 5,2,1
..?????##??? 1,4
?.????.??#??. 1,1,2,1
????.????# 3,3,1
??#???.#?##???.#?? 5,5,2
????????..??#?. 1,2,4
#????#??####???.#? 1,4,4,1,2
????#???#.?????.#.?? 6,2,1,1,1
??#?#????????#?#? 7,2,1
?????.?.#???# 1,1,1,2
??#??...#?#?#??#?..? 3,9
????#?#??#??????##?? 1,1,8,2,1
??##?.?.?#????#?. 4,8
?#???#??#????????. 1,2,9
?#..???..##? 2,3,3
.???#??#??.? 7,1
?#?#??##???#?#..?#?? 14,3
#.????#??.??#?? 1,6,1,1,1
.??#??#.??#?##??##. 2,2,10
?#??????#.?#??#?? 5,2,5
???#??????#??..?#?# 1,8,1,4
?.???????# 1,1,2
?##???#????.?.#?? 6,2,3
?.?##????#?# 7,1
?.?.???#??#.? 1,5
?#?.###???? 3,3,2
.????????.?????? 1,5,1,1,1
??.???##????.? 2,2,3
???#?.#?#?#??#?? 1,2,3,1,4
.??.?????? 1,1,1
???#?#????#????#? 10,3
???.??.?.??? 1,2,1
????#??####? 1,1,4
??????????##?#???? 2,9,1
????.#??#. 1,1,2
#????#??#??? 4,1,2,1
??.??#???? 1,4
.?.?..##.#.. 1,1,2,1
.???.??#???.. 1,6
#?.???.??#. 1,2,2
?##???????#??#. 3,2,6
????##?????#?.????? 2,3,4,4
?..###?#??#???#???? 1,6,1,6
??????.#????#? 2,1,1,2
?#?????.?# 2,2,1
?????#.??#.? 3,2
?..?..#??##?# 1,7
#????#?????.? 1,8
???????#???#?#?? 2,3,4
?#?#????#?. 1,3,1
?#?????#????? 1,4,1
?#????##?. 4,2
???????#??#??????? 8,1,4
??#??.??##?????? 1,1,1,1,6
#?#??.??#???#??? 4,9
???.?????.?.?.?? 2,4,1,1,1
##?#?.?.#?. 5,2
????.???... 2,2
..?????#?????#?? 1,8
#.#?#.##?.???.?. 1,3,3,3,1
?.???????#?????????. 1,1,10
??.??#????##??. 2,4
?.??#?????##??#? 1,9,1
?????#?#?#?? 1,9
?????#?????.?. 6,2,1
??.?.??.?????#..#? 1,1,1,6,2
??#.#???????. 1,1,5
?#.?#..??.?#.#?#?? 2,2,1,2,4
???..???#??##???? 1,1,6,3
.?#.?.####?? 1,5
??.??.?#.?#????? 1,1,1,7
??????????##? 5,1,2
??#????#?#???? 3,5
#.?.??...? 1,1,1
##??#???.?..????#?.? 3,4,6
???#?.?#.??? 5,1,2
.??????#??#? 4,1,2
??.#?.?..??#???..#. 1,1,1,1,4,1
?.?#?#?.???###?.? 4,4
?#??#?#????? 7,2
#???##???#?#?.?#.?? 6,2,2,2,1
?##?#???.?#? 7,1
?.??#??????. 4,1,1
#?##?#?????#. 6,5
.????.?.?? 2,1
???.??.????? 2,2
??#?#????????#?#?. 9,3
?..????##????##?#. 1,14
.????#?????#????#?? 12,1
?????#?#?##? 1,1,7
?#??#.??.?.?? 1,2,2,1
..??#.???.??????# 3,2,5
?#??#?#?##?????##? 10,4
???????##?. 1,4
..#.???.????.. 1,1
???#??.?#?????? 5,4,1
?#?##.???#??#????#?? 5,1,1,4,1
?#?##?.??????????. 5,1,7
?#?#.???????#..#. 1,1,5,1,1
.?.?#??#???.?#????? 8,2
????.??..???#??#?# 2,1,1,9
?#?????????#?#?#??? 1,1,1,1,6,1
??##?#?????.#? 7,1
?????..???#.? 2,2,1,1
#??????#???????? 9,2
??#?????####????.#? 4,10,1
?????#?#?.??? 1,5,1
##.????????.?.?? 2,2,3,1
#??.?#?#??.#??.? 1,5,1,1
??????#???????.?#?#? 7,2,1,5
?.???..??? 2,1
.????#??.??#?. 1,4,2
.??????.#?##..?#???# 2,1,4,6
??##????.??? 4,1,2
?.???????#?? 1,3,5
.#???????.???#???.?? 8,1,2,2,1
??.?#?.?????#??? 2,1,3
#??##????#??.?.#???# 1,8,1,1,1,1
.#.?#??##????#? 1,5,2,1
?#.??.#?????##??? 1,1,3,4,2
?#??????#?#???.#?#? 6,1,3,3
??#??????.##???#??? 1,1,1,8
.??????????? 1,4
.?#.???#.??? 2,1,1,1
#??????##???????# 4,1,3,2,2
???????..?. 1,2,1
???#???.?.??????? 3,1,2
??###??#??#?. 4,1,1
??????????.#.?? 9,1
?##?.##??????.#??? 3,7,2
?#???????????#??.?? 2,1,1,1,5,1
?.?#????.???. 1,2,1,2
?????????#???#????. 2,1,9
???#??#??????##?? 10,2,1
?????#.??.??. 3,1,1
#?#?.???.#? 3,1,1
?#?#??????? 6,2
?????????.? 4,1
????#.??#???#??? 5,7
??.#?#???#???? 1,11
..????.#?#? 1,1,4
??.?#?#????.???# 2,1,1,3,3
?.??.?#?#??? 1,6
??.???##???##?.#### 2,1,7,4
?????###??#??? 2,4,1,1
??????.??###??.##?#? 5,4,4
??.?#.???. 2,2,3
..??#??.?????#? 2,6
???????##? 1,1,3
#..#??????#??#..?##? 1,1,1,6,2
???????#?#?? 2,5
.?##??.????? 3,1,1
??#?.?#?#??#?? 2,8
.#.?.#???#?? 1,1,5
.?.?.??.?????#??##?? 1,2,1,3,3
??.?#????#????#??? 2,2,2
?##?#?#??##?.#? 7,2,1
#?#?#?????##???#?.## 1,1,1,1,8,2
??..????#? 1,1
..???#.?#???????. 1,1,3,4
?#.????????????# 2,1,1,1,6
?##???.?.????#????? 4,1,5,1
?#?.???.#..###?.#. 3,1,1,1,4,1
????????????????# 3,1,4
??.#?.#?#??#? 1,4,1
????.????? 1,3
??#?..????? 3,2
??.??.?###..? 1,1,4,1
?.?##??..?# 5,2
??.????#????#??.? 1,1,6,1
#???.???.??.?##. 1,1,1,1,3
??????##?###??#?.??? 1,1,9,3
.#??.????. 2,2
#.???????#???????#?? 1,1,7,1,4
?????#????#?? 1,6
?.??.?#?.#?? 1,2,2
????????#???## 3,2,3,2
??.??..?#?. 2,1,1
?##??...???? 2,1,3
.??##?.#?.#??..#?#.. 2,1,3,3
.#?????#????# 1,8,1
?#?.?..????. 1,1,2,1
#?#?##.?## 6,2
???#????.?#.?.??#?## 4,1,1,1,1,6
??#????#?##?#?? 1,7
..?###?#??.??#???. 6,2
???????##.?????##?. 1,2,2,2,4
..?#?..???. 3,1
#???#?##???.?????? 5,5,3,1
.?.??.?.#?#?#.????.. 1,5
.#.#??.?#?.???? 1,2,3,2
?##.??#??? 3,1
???#?#???.? 3,4
.....??###??..???.?? 3,1
..?????#?#?#????#??? 1,5,1,1,4
?.#????????#???.??? 1,5,1
.?#??????????. 1,2,4
?##??.????.???????#. 4,3,4
?.?.??.???..??? 1,2,1,3
???????#?. 3,1,1
??##??#?##?????#?.. 6,5,2
?#.??.??...?.? 2,2,1,1
?????#?.?#.?.? 6,2,1,1
?????#???? 2,2,1
??#???????# 4,1,2
?##?????#???.?. 4,2
????.??#????#?? 1,9
??#??##?##????????? 1,8,1,1,1
??.?#.???#???#??#??? 1,1,14
??#.?#??.??.?#?? 1,1,1,4
?.##?#.??????#??? 1,4,2,3,1
?????????????..???? 10,1,1
??..?##??#.????? 2,5,2
????????????#?#?#.?? 1,5,1,1,1,1
???...????????.#?? 2,1,1,2,1,1
?#?##???#???.#?????? 8,2,1,1,1
????????????? 1,6,1,1
?.???#.?.##?. 1,1,1,2
?#?????.?# 2,1,1
????????.??# 2,1,2
???????.?##?????. 1,1,3,3
?..##?..?###???#?? 3,8
??#???.????#????...? 4,9
.?????????? 1,4,1
?##?????..?. 3,1,1
.##??????#. 5,2
??#??????.?.????# 2,1,1,3,1
..#???##???????? 7,5
#???#?#..???.???. 7,1,1,1
?.?#????...#???? 2,2,3
????#???.? 1,4
???#?##????#??.??. 12,1
??????#???.???? 1,7,1,1
?????#???.????? 1,1,2,1,1
?.??????????###? 1,2,1,6
.#?#.????#????? 1,1,1,5
..?#?????.#? 4,1
?.????..?.#? 1,2,1,1
????#???#?#?. 1,3,1,3
??#?#??##.?#?? 8,3
?.???##??..??.?? 2,2
???????????? 1,1,5
##?###???.?? 6,1
?????..??????#?? 4,2,5
???#?.??????????#?. 4,1,1,1,5
??#?????????? 3,2,1,1
?#??#??????..?????.? 6,1,5
?.???##?????? 1,1,3,1
.?####???#.#..# 8,1,1
???.??.??#??? 3,2,1,1
?##.?#.????#??.?? 2,1,5,1
????????####.?..?## 10,2
..?#.???##? 2,5
##.??????#?????? 2,9,2
???##?.??#?????#??? 2,2,3,1,2,1
.##?????## 3,2
??#??.???..?.?.??? 2,2
#?##?.?????#?##???## 1,2,6,2,1,2
??#?#??.#?.??#?? 3,1,1,1,5
?.#.????#??#????? 1,6
???#???????.??? 1,3,2,2
?#?#?..????.?#? 1,2,1,1,1
?#?#???#?#??????#?? 3,7,4
??#???#????#??.. 2,2,1,4
.#????#?#?. 3,3
?#?..?##?#??##? 1,8
.??#?#???#?.??#??? 6,2,6
?#.???.???? 2,2,3
..?#??.?##??#??.?? 3,7
?#?????.?#??????? 4,1,1,1,1
?##??#???.????#? 8,2,1
?.#???#??. 1,3
???##??#?#???#..?? 5,1,1,1,1
???.???????#????? 2,2,8,1
????##???#??????#..# 5,3,1,1,1
?.???????????.?.? 1,8,1
???.#?#??##?#???#?#? 1,15
????#?????????##? 6,6
??#??????????#??##?? 4,5,4
??.???????.? 1,2,1
#???..?##.. 1,2,3
.#####?.?.????# 6,1,1,1
?.#???#???##???.#.? 1,1,3,4,1,1
?#???##??????? 2,5,2
????????..??? 1,3,1,1
???????#???.?. 5,1,1
???.???#????.?????? 1,2,5,3
?????.??.? 2,1
???#???#?.?.#????#? 7,7
??????.#??# 3,4
??#?.??##?##???#?? 3,9
..?##?#????. 3,4
???#????##?#???.. 12,1
???.?#?.?.?.??#????? 1,3,1,1,3,1
#??#??#.??#????###?# 1,5,3,7
?????.?????. 1,2
??????.?.?? 4,1
#???.??#?#?????????? 1,1,7,1,1
.????#??#? 5,2
##.??.##??#?#???#?? 2,1,2,1,1,5
???#??.#??##??????? 1,4,5,1,1,1
?#?#####????? 8,1
##?.??##?#??#.? 2,8,1
??#?.??????????????? 2,7,1,1,1
?.???#?.#??#??? 1,3,7
???????#?#??.?? 12,1
.??#??..#??##?#?. 3,7
??#????.?????.?? 3,1,2,2
????.??#???? 1,1,3,1
???#?##??????# 1,6,4
#???##.??????# 6,1,1,1
.?????##???#??###? 2,8,4
??#?.#?????? 2,2,1
?#?????????. 3,2
??????????.?# 5,1,2,1
.?##?.???... 4,3
??#???????.?# 1,1,4,1
?#???##????.??#? 1,5,4
.?????#???? 2,5
??.?.???##? 1,1,3
.#?#????..???? 3,1,1,1
.???#????# 5,1,1
????.??.?# 3,1,1
.??????..??# 2,1,3
??#???????.????. 3,3
???.#????#?????#? 1,1,2,5,2
.????#?????????. 8,5
.#?.###?##?? 1,7
?.#.??.??#???####. 1,1,1,1,5
.?##?###????? 9,1
.?.?#?#?#?#. 1,4,3
?#?.##???????. 3,4,2
#.??.????????????#?# 1,1,1,8,1,1
#?.??????#????#?#??? 1,1,1,1,4,6
???.??.??# 2,1,1
#??????#???.#. 10,1
?.???#??????.?.?#??# 1,10,1,2,1
?.?##???#?? 3,2
???#...???? 2,2
?#??????????#?## 3,1,1,4
??.??.?#???? 1,1,3,1
.?????#??#???. 4,3
.?#?.?#?.?? 3,1,2
???.??#????.? 1,3,1,1
?#??????.#?????? 3,2
???#????##??#???. 1,1,10
.#?#??????? 5,1
..?.?????????#?#?? 1,13
?????..??????? 4,3,2
?#..?????##?#???.??? 1,9,1,1
?.??#?.??.?? 1,4,1,1
???##?##???.?? 1,8,2
?#???.##?.??? 2,1,3,2
???##?#?#??##??#??? 1,15
.???.??#.#?? 1,3,1,1
??..??#???#??? 7,1
...??.?.?#.?????. 1,1
.?????.??#???#??? 1,2,4,1,1
???.????#????? 2,6,1
.??#?.#??.???#####?? 1,1,2,7
???.???#???? 1,1,6
?.??..????#????#?? 1,6,3
.?#????#????##???.? 12,1
?????????#???? 1,1,4
????.??#?#??? 1,1,1,5
??#.?.???? 1,1,1
?.??#????#?. 1,9
????????#????.. 6,1
?#.?#???##???###?? 1,3,8
???????.???. 3,1
.????..???#? 1,2,3
??.??#...?????.?.#? 1,2,2,1,1,2
???.?.????#?###?#??? 2,12
#.?.??#????# 1,1,1,4
#.???.#?????. 1,1,6
#.????.#?# 1,2,3
?????..??##.?# 1,1,3,1
.??#?#?#???? 5,2,1
.??##???#????#??.... 2,8
??????.#.?#?#??#??? 1,3,1,10
#?#??.#?##.???.#..? 3,1,1,2,1,1
?.??#??#????# 1,10
?.???#???????#??# 1,7,5
?.#?????## 2,3
?#?#?.???.?# 2,1,1,2
#.????????.###?# 1,1,3,1,5
?##????.??? 6,1
??.?#?##?#?.??.? 1,5,1,2
.?.#??????.?? 1,2,1,2
.????.##??..?#..? 3,1
?#??##.????#???#?? 2,3,3,1,4
???#?.???.?? 1,2,3,1
#?#???#.????###? 4,1,7
???.##?????#?#?##?. 1,2,2,7
.##..??.#?#???#???#? 2,2,7,1
...#??#??????? 1,2,2,1
?????..??#???? 5,1,2
???.???????.??? 1,6,1
?.??.?#???#.### 1,1,1,1,3
????.##???###? 1,2,6
..?#??..?.??#?##???. 2,9
.?.??..???? 2,1
??.???.#?#????###??. 1,1,3,8
?.???#????#?##. 1,1,1,6
??.#?????##??#?## 1,1,6,5
?.#??#?.??..??# 5,1,1
?????###.??#???#???# 3,3,4,5
?#..???????.?? 1,5
????##?#?.?????.? 5,3
????#?????. 4,2
?..?.?#???#???? 1,1,2,1,2
??##?#????#???..? 4,2,5
.?.?..????.. 1,1,1,2
?????????.??##????? 1,5,3,1
?.#.???????# 1,3,4
?.??###?#??#..??#??. 9,1,2
?????????? 1,1,1
?##?#???.?????#????? 8,1,1,2,1
??#??##?????. 8,1
.???..?##?.??? 3,4
?????#?.#??##???#?? 2,1,5,3
.#?#?#????.???# 8,4
??..?.???? 2,1,3
.??.???##????. 2,1,3,1
.##???#????#?. 8,3
???.#??#???.#? 1,1,2,2
.???#?#?#?#?##???#?. 10,7
??...???#???# 1,5,2
?????.??.?#? 1,1,1,1
???.???????????###? 1,1,1,7,3
????????#???? 1,3
???.???#????.??# 2,7,1,1
?#?#????#??##? 1,1,4,3
??????#???#?? 4,4
????#?.?.??????#.?. 3,1,1,4,1,1
?#??#???????? 1,10
.???#?#??#???##?? 1,7,5
.???.#???#???? 1,2
??#???#.?##?#? 3,1,6
??????#???#? 4,1,1,1
??#??##??#.#.?#?? 6,1,1,2
????.??#??.?#.?.? 4,4,2
.????#???.?#? 5,2
?.##?#????##???? 6,6
?#??.#??.???##. 1,3,2
???#.#?#?#??..??.? 1,1,7,1,1
.??#?###.?# 7,1
????..?#?? 1,2,2
?#???##?##. 1,6
.#.?.?????????#. 1,3,2,2
?#?#??.?#???##?? 5,1,4
?#?.??????????#. 1,2,5
..??.??????..?#?? 1,1,1,1,4
??##???#????????. 6,1,1,1,1
???#?##??????. 5,1
?#?.?.???? 2,3
????#????#?##????#?? 1,10,3
#?##??????? 6,1
??#???.???#??. 4,2
??##??#???#???#. 5,6,1
?...#???????#?.?.?? 1,2,5,1
???????##?##?#?##??? 1,14,1
?#???#.??????##?#? 4,1,1,6
????????##?#. 4,1,2,1
?#.???????? 1,2,3
.?.???#?#???#? 1,1,8
???##??#???.. 5,1,1
????#??????.?# 2,3,3,2
?#?????##?? 2,1,5
??.#???#.???#? 5,3
??#.?#?#???? 3,3,2
?.?.#?..#? 1,2,2
????#.???? 3,1
?#????????. 3,3
.????.????.? 3,3,1
?##.#??#?#???#?? 2,6,1,2
????##.##????.? 1,4,3,1
.#.???#???. 1,1,3
.?????#.??.?? 3,1
???????#??.# 6,1
?.??????????#. 4,3
??#?#?#?#???#???#. 12,1
?#.??#?#?##?? 2,8
??.??#??#??.???#??? 1,7,4
#.????.?.#??? 1,1,1,4
.?#.?????#??? 2,6,2
???#??.##?#?#??#???. 2,12
?????????####?.????? 1,1,7,4
??.?????????.?.????? 2,1
??##?#?##.??#? 9,2
??#.#.?????#.???# 3,1,2,1,1
???#?????#??##?.?? 2,7
?#?#?.???..???. 3,1
#?#.?????? 3,2
.??#?##???.?.????? 7,1,1,1
??#?#???.#?. 3,1
#.?.???????? 1,2,3
??#??????. 3,2
.?.??.?#?? 1,1,1
.??#.#??#?.#.????#?? 1,1,5,1,7
??????..#.??? 1,1,1,2
.????????#.??????? 2,3,5
?.??????##??##????. 1,8,6
?.?#?#??..##?????# 5,8
?????#?.?.? 2,1
??#??##???#?#. 1,1,9
??#?#??.?#???#?? 4,7
.??.?#.??#??? 2,4
?#?????????#???#?#?. 1,1,1,1,1,6
??????.#??? 5,3
?????###??.#???? 2,6,4
?????#?#???? 1,1,5,1
?.??????#?###? 1,2,1,5
##??#??.?#???#? 5,1,1,1
#???#???.?? 1,5
???.?????#?? 1,8
???????.?##??#.??# 5,1,3,1,1,1
?.?.????.#?#???#???? 1,1,1,7,1
????#???#???#????? 2,1,2,4,1
??#?????????? 2,1,4
???#?.#????. 2,4
?.??#???.##.? 2,2
?#.#??.??????##?# 1,1,1,7,1
?..?#?#.??#???.?. 3,4
????.#???#??#??#??#. 2,1,2,1,2,2
??????#.##?##?.?.? 1,1,1,6,1
????????##?#?# 2,1,6
.#????#.???????? 6,2,3
#??#???#????##??. 8,1,2,1
?.?.?????#?#??????#? 1,9,1,1,1
#???#?..?#??#??.??. 1,4,1,1,1,1
??##?##.??###????.? 6,7,1
.?????????? 1,3
.?????.?#.??#???.. 1,2,5
.??.???.??? 2,1,1
???#????#?#??#.#.?? 1,8,1,1,1
?.???..?.? 1,1
..??####?#.????#.? 6,3
?????#????.???#?# 7,1,3
###..????????##??. 3,8
??.?#???#???????# 1,2,6,2
????.???#?..? 3,4
.???.??#???## 1,8
???????#?.? 1,2
?.?###.??? 4,1
????????.# 4,1
??????????????. 2,1,1,1,1
?????????? 1,2,2
#???.?????.??# 3,1,1,3
?###??..?##???.?.?# 4,5,1
???.?##??.?#???#??# 3,3,1,1,4
.???????????. 1,2,1,1
????...???. 2,3
???##.???????? 1,3,2,4
##?#??.????##????.?? 5,6,1,1
???#?????##.#.?#? 1,2,5,1,2
.?.??..???? 2,3
???.???.??##???.# 2,1,4,1,1
#????#?#?? 2,5
?.??.?#?#? 1,1,3
.?.??#??.??#.????? 1,4,3,1,2
#.?????.????.??.?. 1,3,1,1,1,1
???#?#?#.#??#??????# 1,1,3,7,2
????????.??? 1,1,1,1
???????#?. 2,2
.???????..?#??? 1,1,2,1,1
?.??.?????#???.? 1,1,2,6,1
????##?????.??? 1,3,1,1,1
????#???#..??.? 1,4,1,1
??????#???.?? 5,1
????.?.?????? 3,1,2,2
?.??.??.???#????# 1,4,4
.?????.##?????? 1,2,8
????.???#???#??? 2,8
.?????????.???.?.?. 7,2
?#.?#??#?#???#?.???. 1,1,8,1,1
???????#??##???#?# 1,2,1,8
???#?#?.?. 1,4
.#.?.#??##??? 1,7
.????????.. 2,3
???.?#???.???? 1,5,1
???#?#?????????##?#? 7,6,1
?#???#?.?#...? 5,1
????#??.#? 1,2,2
??#????#??# 2,1,5
.##??##??#?.. 2,2,2
#???.???#?.?.#???? 4,1,2,1,1,1
?##????.?????????.?? 7,1,1,3,1
??.??.#????? 1,1,2,1
???#???.???# 1,4,1,1
?.????#??#??##? 1,1,3,6
??.??????#.?.?#???? 1,1,1,1,1,4
??.????.?.#?????? 3,6
??###??##???#?#? 6,2,5
??#?.##.?#? 1,2,1
?..??????.??. 1,4,1
?#?#??????.??#??? 8,3
.##?#???????? 7,2
?.?#.?.#???.. 2,4
?#??#????#??#?? 2,3,6
?...???.???#?#??? 2,6
?##.?????.??? 3,2,2
??#???.????.#? 4,2,1
??#????????..#???. 1,4,3,3
??#..??.?#?. 1,1,3
?.##????#??#. 3,1,1,1
???#??.?#??????. 4,6
?.???#?#??.??#.#?? 1,2,3,3,2
??#?????.???. 3,1,3
???##?.?#.?.??? 1,3,2,1,1
???##??##?????? 1,11
?#.??#??????. 2,1,1,1
?..?#????.#??? 6,1,1
????#???#??#?. 4,4
.??#?#???#?? 1,1,6
#?????.??.#?? 1,4,2
?#???.??????#?.#? 2,2,5,1,2
??#?##??.? 1,5,1
??????#?.??? 1,5,1,1
???.?#????.?##????? 5,4
??.?#???.??#??? 4,2
??#?#??#?##?#?.??? 5,6
??????#??????.. 1,7
?#?#??#.???.?#? 4,1,3,1
?##???...#????????## 5,3,5
??#?#????????????? 1,8,1,3
??#???????.. 4,2
????..??????#???? 2,11
?#.??#?#?????..?#. 1,5,1,1,1
.#??????#????#.? 2,2,1,1,1
????????.???.??#??.? 2,1,2,2,5
?????????.#?##?#?.? 2,6
?..?.???#???###?? 1,8
????.??????###???? 2,7
?#?.??.#???#?### 1,2,1,1,5
.#????.?#? 3,1,1
?.??#?#.#?..# 5,1,1
???...?..????. 1,1
?.???#?#?#?#.? 6,3
##..#???#????? 2,1,4,1
?????##?#?#???#???? 1,15
??.????#???????? 1,1,6,1
?.???#?.?????? 5,1,2
??#?.?.?#?#??.? 3,1,1,1,1
???#??????????? 2,7
.????????#???# 7,1,1,1
?##?#???.???? 2,1,3
??#??#?#.?????#???. 7,1
??.????#????#?#?# 1,14
.????#???#???? 1,6
##??#?#.?#.#? 7,2,1
??..?.?##?. 2,2
??#?#???.#..#.??? 6,1,1,1
.##?.???.#? 3,1,1
????#????#?#?? 2,8,1
.???????????????? 1,3,1,4
?#????###????????? 4,7,1,1
#?.?#???.?#?#?#?? 2,1,1,7
???#????..?? 5,1
?#.?#?????.?# 1,1,2,1
??##?#??#??#??.?#?? 9,1,1,2
##?#?.??#?? 4,2
..#???#?.??#####?.? 6,5
??##????#? 3,4
##.#?#??#??##?.? 2,1,9
????#??????.?#???#?? 1,8,6,1
??#??#.?#.?#??.??.?. 5,1,1,1,1,1
?..#???.???#???? 1,2,1,2,2
.???#??????????##. 4,2,4
##??#????.??.??? 2,3,1,1,3
?????.???##???? 4,5,1
.?#?????##???# 1,5,1,1
?#?????#... 3,2
????????.?#?#?? 1,3,3
??.??#??..?##? 1,4,4
?????????#?????? 3,1,6,2
??????????.#? 1,1,5,2
????.###????????? 4,10
???#??..?.??#????? 1,4,1,1,1,1
?.??##?##???###? 1,12
?????????? 1,1,1
???#?.???#? 1,2,3
?.????#..??? 1,5,1
????##??..?#?. 1,5,1
?#?#?#?#?????#?.?. 6,1,1,2,1
??#??##??#?.??..???? 1,7,2,1
.????????????# 2,1,1,2
.#?#??.??#??#? 4,2,2
??#?#????? 4,3
????????????##??? 1,1,7
??.????????? 1,2,1,1
##??????..????? 5,1,1,3
.##?#?###???##??? 4,9,1
#?????.?#..? 2,1,1,1
#????#????#?.??#.#. 3,6,1,1
.?#????#?#??????.?#? 2,1,1,5,2
.????#?#.#???? 7,4
..#???#????.?#??..?. 1,3,3,1,1,1
???..??##?#????? 1,9
?.?.??##?..# 1,2,1
???###????#??????..? 1,6,1,3,1
.??.??????.?? 1,4,1
.??.#.#?.#?. 2,1,1,1
?.???#??#???.??#?.?? 2,1,4,3,2
??#??.???#??# 2,1,4
#?.#??..?? 1,1,1
??#?#.????????#?. 1,1,1,1,8
?..?#?.#?##.#??##??? 1,1,4,1,5
???.???#?? 1,3
.??#.??#?#????##?#?? 2,13'''

rows = rawInput.splitlines()

optionsCache = {}

def addCache(spaces, items, count):
    secondaryKey = ','.join(str(x) for x in items)

    if spaces not in optionsCache:
        optionsCache[spaces] = {}

    optionsCache[spaces][secondaryKey] = count

def getCache(spaces, items):
    secondaryKey = ','.join(str(x) for x in items)

    if spaces not in optionsCache:
        return None
    if secondaryKey not in optionsCache[spaces]:
        return None
    return optionsCache[spaces][secondaryKey]

def getOptionCount(spaces: str, items: [int]):
    cacheValue = getCache(spaces, items)
    if cacheValue is not None:
        return cacheValue

    if len(items) == 0:
        if spaces.count('#') == 0:
            addCache(spaces, items, 1)
            return 1
        else:
            addCache(spaces, items, 0)
            return 0

    item = items[0]

    minWidth = sum(items) + len(items) - 1
    freedom = len(spaces) - minWidth

    if freedom < 0:
        return 0
    optionCount = 0

    for i in range(freedom + 1):
        fits = True
        if i + item != len(spaces) and spaces[i + item] == '#':
            fits = False
        elif i > 0 and '#' in spaces[:i]:
            fits = False
        else:
            for j in range(item):
                if spaces[i + j] == '.':
                    fits = False
                    break

        if fits:
            options = getOptionCount(spaces[i + item + 1:], items[1:])
            optionCount += options
    addCache(spaces, items, optionCount)
    return optionCount

total = 0
i = 0
for row in rows:
    spacesTxt, sequence = row.split(' ')

    sizes = list(map(int, sequence.split(',')))
    smallSpaces = re.sub('\.+', '.', spacesTxt)
    bigSpaces = re.sub('\.+', '.', '?'.join([spacesTxt] * 5))

    bigSizes = 5 * sizes

    total += getOptionCount(bigSpaces, bigSizes)
print(total)