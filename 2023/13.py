from AOC.shared.utils import flipGrid

rawInput = '''
#.#........
##...#####.
#.##..####.
##..##....#
#..#.......
#.#####..##
.....#.##.#
.###..#..#.
##..##....#
###..######
##.##.#..#.
..#####..##
###...#..#.
.......##..
#.#.##.##.#
.#.##.#..#.
.#.##.#..#.

..#.###
#.#####
#.#####
..#..##
#......
##..###
..#....

.##...#.#..
#..#..##..#
##..#####..
##..#####..
#..#..##..#
.##...#.#..
..#.###....
###.####..#
#..##.#.##.
###..#.#..#
###..#.#..#
#..##.#.#..
###.####..#
..#.###....
.##...#.#..

..####..#
#.####.##
#.####.##
..####..#
.######.#
#..##..##
.#.##.#.#
#....#.#.
#.####.#.

.#....###
......#..
..##.#...
##..#....
#####.#..
#####.###
##..#....

.#.##.#...#....
.#.##.#.###..#.
##..#.####..##.
##.##.##..#..#.
##.##.##.#..###
.#.##.#.#...#..
...##........##
#..##..####...#
#..##..#..##.#.
##.##.###.#..##
..#..#....##...
...##.....#####
.#.##.#..##...#
.#....#.....##.
.#....#.....##.

...###..##.
#####.#..#.
.##.#..##.#
.##.#..##.#
#####.#..#.
...###..##.
....#.###.#
##.#.....#.
#...###....
####..###.#
####..###.#
#...####...
##.#.....#.
....#.###.#
...###..##.

.##..#..#..##..##
.#.##.##.##.#..#.
.##.##..##.##..##
#.....##.....##..
.##.##..##.#....#
.##.######.##..##
...#......#......

##..#.##.#...#..#
#.#...####.......
.####...###.#.##.
.####...###.#.##.
#.#...####.......
##..#.##.#...#..#
#.#####...##.###.
#..###...#.#.###.
...#..#.###.#...#
.#.###..#####....
.#####..#####....

.##.####..#..####
##..#.#.......##.
...##...#.#..##..
...##...#.#..##..
##..#.#.......##.
.##.####..#..####
##.#..####..#...#
...#.####.#..#.#.
#..###...#.#.#..#
###..####.##..#.#
..#.##.....####.#
...#.#.#..#...##.
...#.#.#..#...###

#....##.#####
#....#...####
.#..#.##.####
######.#.....
##..##.######
......#.###..
.####.##.####
..##.....##..
#.##.#.#.....
.#..#.#.##...
#.##.#.##.#..
.####..##.###
#.##..#.##.##
######.#.#.##
.......#...##

#..#.#######..#
.#..###.#.####.
.#..###.######.
#..#.#######..#
#####........##
.###..#.#....#.
.###....##.####
.#...#.#.##.#.#
..##....#.###..
###.#....#.#...
#..#.###..#####
#..#.###..#####
###.#....#.#...

#.#..##...####.
...#..#.#.#..#.
...#..#.#.#..#.
#.#..##...####.
.##.#.#.##..#.#
..##....###..##
###.##.##..##..

...##...##.
#......###.
#.#....#..#
#.#..#.###.
.##..##.###
#.#..#.#..#
.#.##.#....
#..##..#.##
#..##..#.##
##....##.##
##....##.##

####.##....##.###
###....####....##
..#.#..#..#..#.#.
####.########.###
###...#....#...##
##..##..#...##..#
##..#........#..#
...#....##....#..
..#.##.#..#.##.#.
.......####......
###..#..##..#..##
...#...####...#..
.....###..###....

#.....##......###
...#.#..##.#..###
#.#.#..#.....####
##..###..#...#...
.#####.#.#.#....#
.#####.#.#.#....#
##..###..#...#...
#.#.#..#.....####
...#.#..#..#..###
#.....##......###
..##.#..#.#.#.##.
..###.#.####...##
..###.#.####...##

##..##.#..##.##..
##..#.#.###.#..##
#.#..#...#.....#.
..#...#.#.#####.#
.........####.#.#
###.#.#...##..#..
....####.###.##.#
.....#.#..#..#...
##...#.###....###
..#.###...##.#.#.
##..#.####.#....#
##.####..#..#..##
..###.######...##
###..#.###.#.###.
###..#.###.#.###.

.#.###...#.#.
#####..#..##.
#####..#..##.
.#.###...#.#.
...#.....#.#.
.#.#.#.#.#.##
##..##.#.####
..#.#..#.#.#.
#..####..#.##
#####.###.###
#####.###.#.#

#....##..##....##
#.##.##..##.##.#.
.#..#.#..#.#..#.#
################.
#....##..##....#.
..##..#..#..##..#
................#
.....#.##.#.....#
.#..#.#..#.#..#..
..##........##...
.####.#..#.####.#

####.#...#..#
####.###..##.
....#..###..#
.##....##.##.
.##.###...##.
#..#######.##
....##.#.#..#
######...#..#
.##.####..##.
#####..#.....
#..#.####....
#..#...#.....
.........####

####.#..#...#
.........##..
#..#.#..#.#..
#..#.#..#.#..
.........##..
####.#..#...#
#...###..###.
#..#.##...#..
#########.#..
####...#.#.##
#######...#..
....####.#...
....##.......

.#...#....#...#.#
.#...#....#...#.#
..#..........#...
#...#.####.#...##
#.#..#.##.#..#.##
..#..........#..#
.#.####..####.#..
.#..##....##..#..
#..#..#..#..#..##
###.###..###.###.
##.#.##..##.#.###
##.##.####.##.###
...#...##...#...#
..#.##.....#.#..#
....###..###....#
#..#.######.#..#.
.##..######..##.#

.##.#####.######.
..##..##..#.##.#.
..##..##..#.##.#.
.##.#####.######.
....#####..##.#..
#.###############
#.....#.#.#.##.#.
##..#..#.########
....###.#.##..##.

#.##..#
#...##.
.##....
#..####
#.##..#
...#..#
...#..#
#.##..#
...####

..####..####..#
...##...###....
........#######
#.######.#.#..#
##.##.#########
..#..#...###..#
##.##.##.###..#
########.##.##.
#.#..#.#.#.....
...##...#......
##.##.####.####
.#.##.#.#......
##....##..##..#

#.#...##...##..
#..##..########
#..##.#.#.#..#.
...###.........
...###.........
#..##.#.#.#..#.
#..##..########
#.#...##...##..
.#.#.#.#.#....#
##.###...#.####
.#..#.....#..#.
...##..#..####.
###..##..#.##.#
#.#..##########
.....##..##..##

....#.#
#####..
.....##
.....##
#####..
....#..
.##..#.
#..##.#
####...
.....##
#####..

#..#.##.###
..###.###..
###..#..###
........#..
###.#..##..
#...#..#...
#..#.##..##
#...#...#..
.##...##...
#.##.#.....
#.#..#.....
.##...##...
#...#...#..
#..#.##..##
#...#..#...
###.#..##..
........#..

####..#.#...#
####..#.#...#
##....##.##.#
...#...#####.
...#..###.###
#.#.#.#..#.#.
##....####..#
....#.#..###.
####.#.#.#.##

#...##..##.
#...##..##.
#.##.####.#
#.##.####.#
##..#....#.
......##...
.#...####..
####.####.#
.##########
##.#......#
....#..#.#.

#...#.##..##..#.#
.###.#......#.#..
##.##..#...#.####
.#..##.#..#.###..
..#.#..#..###..#.
..##....###.#.###
#..#..#####..##.#
...##...##..#..#.
...##...##..#..#.
#..#..#####..##.#
.###....###.#.###
..#.#..#..###..#.
.#..##.#..#.###..
##.##..#...#.####
.###.#......#.#..
#...#.##..##..#.#
#...#.##..##..#.#

.....#....#....
.#..#......#..#
.#..###..###..#
.....#....#....
#.###.####.###.
.#..##.##.##..#
.####..##..####
#.##.######.##.
##..#..##..#..#
.#####.##.#####
#####..##..####
##..###..###..#
.#..###..###..#
.....##..##....
#..............
##..#.####.#..#
..##.##..##.##.

##..######.##..##
##...######.#.###
#.##.####.###....
#######.#....#...
#.##.#.#####..#..
..##...##########
.####..#..#.###..
##..##..#...#..##
#....###.##..#.##

##....###..#..#
...##..#.#.#..#
..###..##......
######....#####
.###..#...#.##.
..#...#..##....
##..#......#..#
..##....###....
..##.##.##.#..#
##.#.#...#.####
...##....######
###.#..#.##....
....######.....

..###.#..#.#.#.
...#.#...##.#..
....#...#.###.#
....#...#.###.#
...#.#...##.#..
..###.#..#.#.#.
###.##...#.###.
..##.#..#..#...
##..###.###..##
..#####...#..##
####.#.#..###..
#######..##.##.
..#..###...#...
#....#..####.#.
##.####.##.##..

###....
#...#..
##.##.#
#.##.##
...####
..#.##.
..#.##.
...####
#.##.##
##.##.#
#...#..
#.#....
#.#....

##.##.##..#..
#..##..##.#.#
#......#.###.
########.#.#.
#.####.##.#.#
#.####.##.#.#
########.#.#.
#......#.###.
#..##..##.#.#
##.##.##.##..
#.####.##.#..
...##...#.#.#
.##..##.##..#

###.#####.#..#.
...#.#..#..###.
##..####.#.##.#
###.#..###.####
###.#..###.####
##..####.#.####
...#.#..#..###.
###.#####.#..#.
##...#..#....##
...#...#.######
....#...#####.#
##.####.##.##.#
##.#.##..#..#.#
####..#.#..##.#
....#..#.##.#.#
###...#.###.#..
##..#...##.#...

.....#..#..#.
#..#...######
.#####.#####.
#####.#..##..
.##...#.#..#.
#.##..##....#
#.##..##....#

###.#.##...
#..#.#...#.
.##..##.###
...##.#....
##########.
..###..#..#
....###.#..
....###.#..
..###..#..#
##########.
...##.#....
.##..##.#.#
#..#.#...#.
###.#.##...
###.#.##...

.....#..#.......#
....#.##.#.....##
.##.##..##.##.##.
...#.####.#...###
#..#..##..#..#.#.
.##...##...##...#
####..##..####...
.##.#....#.##...#
.##..#..#..##..#.
#..##.##.##..###.
.##........##...#
#..##....##..##.#
.##.######.##...#
#..#..##..#..#..#
.##..####..##...#

####...##........
.#...##...#####.#
.#...##...#####.#
#.##...##........
.######..#.#####.
#.##..#######.###
.##...######.##..
.##...######.##..
#.##..#######.###
.######..#.#####.
#.##...##........

#########.#..#.
#.....##.##.##.
.#....#.#######
.#....#.#######
#.....##.##.##.
#########.#..#.
.#..#.##.#...#.
#..####....##..
.#..#..#.###.##
#..#....#######
#.#######..##.#
#.#######..##.#
#..#..#.#######

..........#..#.
...##...###..#.
..#.##....####.
.....#..#..##..
..###..##.#..#.
##.##.###.####.
..##.###.######
....##.##..##..
......####.##.#

#.####.####.###
#.####.####.###
.##..##.#####..
...##.........#
#..##..#.#.##..
##.##.##.#.##..
.######...##.##
###...##......#
#..##..##..#.##

#...####..###....
.###.#....#######
.###.....#.###...
..####..##.#.....
#.###....#.#...##
#.###....#.#...##
.#####..##.#.....
.###.....#.###...
.###.#....#######
#...####..###....
#.##.#..#...#..##

..#..######..
..#..#.##.#..
####.##..##.#
#...#......#.
#.##.######.#
####........#
...####..####
..###..##..##
...####..####
###..........
###..........
...####..####
...##..##..##

##.#..#.###.#..
#.##..##.###.#.
#..#..##.#..##.
.#..##..#..###.
.#......#.##..#
###....#######.
####..####...#.
.#..##..#.#..##
.#.#..#.#..#...
#.#.##.#.####.#
..........##.#.
..........##.#.
#.#.##.#.####.#

..#####
.##.#.#
#.##.##
...##..
#.....#
#...#..
#...#..
#.....#
...##..
#.##.##
.##.#.#
..#####
..#####
.##.#.#
#..#.##

##.#..#..#####.
##....#..#...##
..#..#.##.##.#.
##.#.####.#.###
..######.#.##.#
.##..#.#..###.#
##..#.....#..#.
......#..####.#
######.###.##.#
...####..###.##
##.#..#...#.#.#
##.#.#........#
##..##.#####.#.
..#.##.#..#..##
..#.##.#..#..##
##..##.#####.#.
##.#.#........#

.#.##..
.######
#....##
..#.#.#
.....##
#..##.#
#..##..
.##..#.
##.##..
###.#.#
###.###
###.###
###.#.#
##.##..
.##..#.
#..##..
#..##.#

.####.#..##..##..
......#....#.#...
#....#.#..####.#.
#....#.#..####.#.
......#....#.#...
.####.#..##..##..
#....#..##..#.###
#.##.#...##.##..#
..##..#.##....#.#
..##......#.##...
#.##.######.###..
######.#####.#..#
......#.#.##..##.
##..#..##...#...#
.#..#.##..###....

#....##.##..#
.#..#.###...#
.#..#.###.##.
#######.##.#.
##..##.#####.
##..###....##
##..####...##

##.#.#..#.#.#
..#..#..#..#.
......##.....
.....####....
..##....#.##.
##....##....#
###.#.##.#.##
..##.#..#.##.
##..######..#
####......###
#####.##.####
....######...
####..##..###
##.#......#.#
......##.....
##.##....##.#
##..........#

..##..#.#...###
#....#.#####...
.#..#.#.##..#..
.....##...##.##
........###..##
.......#.###.##
#....#..###.###

#####..
.#..#.#
.####..
..###..
.#..#.#
#####..
.##....
.##....
#####..
.#..#.#
..###..
.####..
.#..#.#
#####..
..####.

.######...##.
....#.#.##..#
...##..##....
...##..##....
....#.#.##..#
.######...##.
#..#.....#..#
#.####.##.##.
..#.####.#..#
#...##.##...#
......##..##.
#######......
.#.#.####....

.#.#####.
...#....#
...#....#
.#.#####.
#.#.#..#.
..##.##..
..#..####
##.#.....
.##.#####
#.##..#..
#.###.#..
.##.#####
##.#.....
..#..####
..##.##..

..#....
...####
#.#####
...##..
...##..
#.#####
....###
..#....
#......
.#.....
#......
.#.####
.....##

.....###.###.
##..#####..#.
######.####.#
##.##.#.###.#
.....#..#.##.
.....#..#.##.
##.##.#.###.#
######.####.#
##..#####..#.
.....###.###.
#####.###.#..
#...#.##..#..
..#.#.....###
####...###...
####..###.##.
##.##...##..#
....##.#..##.

...#..###
...#.....
..###.#..
##.#####.
...#.#.##
###......
..##.#..#
..##.#..#
###......
.....#.##
##.#####.

#######.##...
.#..#.#.#..##
#.##.####....
......#.#...#
##########.##
#.##.#.#..#.#
#.##.###..#.#

.#...#####.
....###.###
..#.#..##..
..#.#..##..
....###.###
.#...#####.
#..###.#.#.
#..###.#.#.
.#...###.#.

..##..####.
##..##.##.#
###.###..##
..#..#....#
..#..##..##
..####.##.#
#..##..##..
..#....##..
##.###.##.#

##..###..
##..###..
#..#.#...
.##.#....
.....#..#
##...##.#
##....#.#
.##..#.#.
.##..#.#.
.#....#.#
##...##.#
.....#..#
.##.#....
#..#.#...
##..###..

####..#..##..#.
######.##..##.#
.....##.......#
....##..#..#..#
#####..#....#..
.##.#...####...
......#..##..#.
#..#..##....##.
.......#....#..
######.#....#.#
.##.##..#..#..#

#.#.#.##..####...
..##.###.#.#.##..
...#.......#.##..
...#..#..##...###
...#..#..##...###
...#.......#.##..
..##.#.#.#.#.##..
#.#.#.##..####...
.#.#..####..#....
....####...#...##
#.....#.#..#.#...

#..###..#
#..###...
.#....##.
.#....##.
#..###...
#..###..#
.#..#..#.
#####..##
#..#.....

#..#.###.......#.
.##.......#.#....
....#.###.##..#.#
#..##..#..#...###
....#..#####.#...
#..#..#.#..###..#
#..#..#.#..###..#
....#..#####.....
#..##..#..#...###

...#..#
.....##
....##.
##.#.#.
..#.###
..#...#
......#
...#.#.
#.##.#.
##...##
###.#..
###.#..
##...##
#.##.#.
...#.#.
......#
..#...#

##########.###.
.##..##..#....#
#..##..###..#..
#..##..#..##.##
###..##########
.##..##...#..#.
.##..##...#.#.#
##########....#
#..##..#..###..
..........#.#..
#..##..##..#.#.
#..##..#...#..#
.##..##.#.....#

##.##.##..#
.#.##.##...
###.#.##.##
.#.####.#..
.#.####.#..
###.#.##.##
.#.##.##...
##.##.##..#
####..##.##
.####....#.
..##..#.#.#
...#.#..#.#
.#####..#.#
.#####..#.#
...#.#..#.#
..##..#.#.#
.####.#..#.

#..##..#....#.#..
....##.#.#####.#.
....##.#.#####.#.
#..##.......#.#..
#..#...##...#.##.
.##...###.##.#..#
.....#.##.#.#..#.
.##.#.########.##
......#.###.####.
.##....##########
#..###...###...#.

#...#...#...#
#...#.......#
....##.#..##.
..#...#.##..#
#.#......#.##
..#..#.#...##
..###.#.##.##
#.###.##..#.#
##..##.######
#...#.##.##.#
...#....###..
....##.#.#..#
....##.#.#..#
...#....###..
#...#.##.##.#

#..##.#......
.##...##.#.##
.##.......###
.....#.#####.
.....#.#####.
.##.......###
.##...##...##
#..##.#......
######...#..#
##########..#
.....####....

....#..######
.#....#.##...
.##..#.#.....
##.#...#..###
##.#...#..###
.##..#.#..#..
.#....#.##...

.#....#....
###.###.##.
#...##.#..#
###.###.##.
##.....#..#
#.##.#.....
##.##.#.##.
####.##.##.
###.#.#####
##.####.##.
.#..#.#....
.##.##.....
.##.###....

....##....#.#
.##.#.#.#....
.##.#.#.#....
.....#....#.#
#..##...#..#.
#..##.###...#
######..###.#
.........####
.##....######
....####..###
#..##...#.##.

....###
....###
#.##.##
##.##..
...####
##.#..#
.#..###
..####.
###...#
###...#
..##.#.

#####.##.....
......####..#
####....#....
####..#.##..#
#####.###.##.
#..####..####
#########.##.
#.####.######
#..######.##.
####.###..##.
####..#......
.##..#.#..##.
######.......

####.##
###....
##...##
###.#..
......#
....###
##.###.
..#.###
...#.#.
####.##
..#....
###..##
#.###..
###..#.
..###.#
####...
####...

..#.#.#.##.#.
#....#.####.#
..##...#..#..
..##...#..#..
#....#.####.#
#.#.#.#.##.#.
#.#..#.#..#.#
##...########
....#..####..
.##.#.#....#.
#...##.####.#

..........#
.#.##.#..##
##....##.##
.#.##.#.#..
..####.....
.######...#
.######.#.#

####..###..####
#.##..###..####
##...#.##.#.###
##...#.##.#.###
#.##..###..####
####..###..####
#.#....##.#.#..
.##.#.....#...#
.##..##.#.#####
.##.###..#..##.
.#.#.#.##.##...

.#.###..#.##.#..#
#..#......##.....
..##..###.##.#.#.
#..##.###.##.###.
.##..#.#.####.#.#
..#.#.##.#..#.##.
..#...##......##.
####.##..#..#..##
...###.##.##.##.#
#.###..########..
.#..######..#####
....#.#.#.##.#.#.
#....###.####.###
#....###.####.###
....#.#.#.##.#.#.
.#..######..#####
#.###..########..

##...###.
###.#####
###.#####
##....##.
###.##...
..###.###
....####.
..####..#
####....#
..#.###.#
..####..#
..##.##..
###..###.

#######....
....#.##..#
##..#..####
..##.#..##.
####.#.####
...#####...
##.###.#..#
###....#..#
...###.....
..##.##....
...###..##.
...##.#####
####.###..#
##.#.###..#
##...##.##.
##.########
##..##..##.

##............###
#####..##..###.##
.#.#........#.#..
###..######..####
.....##..##......
.###..####..###..
#..#...##...#..##

.##...#
#..##..
#####..
.##...#
.##.#..
.##.#..
.##..##

##......#....#...
####...##....##..
##..##....##....#
....##.##.##.##.#
.#.#.##..####..##
#..#.#.##.##.##.#
#.##.##..####..##
..#..#.##.##.##.#
####...##....##..
.#..#.####..####.
.##.#.#..#..#..#.
..#..#.##.##.##.#
#####............

####.....
.##....##
.##..##..
#..##.#..
.#...#.##
####.#...
####.#.##
.##.#.##.
.##..####
......##.
....#..#.
#..##....
#..#..###
######.##
......#.#
####..#.#
####..#.#

.#.##.#.#.##.#.
#.#..#.########
#..##..#.#..#.#
#..##..#.#..#.#
#.####.##....##
#.#..#.#..##..#
###..###......#
...##..........
..####....##...
.######.#.##.#.
#..##..########
#..##..#......#
#.####.#.####.#
#.####.#.####.#
..#..#..#####..

..#..###.#.
#.##.######
#.####.###.
....#..##..
##..##..#.#
##..##..#.#
....#..##..
#.####.###.
#.##.######
..#.####.#.
###.#...##.
......#..##
......#..##
###.#...##.
..#.####.#.
#.##.######
#.####.###.

##..#.#
##..#.#
#.#####
.##.#.#
....#.#
####.#.
###..#.
....#.#
.##.#.#

...##..####..
....#.######.
#..####....##
###..##.##.##
..##.##.##.##
..##.##....##
###..........
#.#.#..#..#..
.######....##

##..####..#
##.#....#.#
..#.#..#.#.
....#......
###.#..#.##
..##.##.##.
...#.##.#..

.##.#####
....#..#.
#..#.##..
#..#.##..
....#..#.
.##.#####
#..#...##
####.##.#
..#.##.##
.....#.##
.##.####.
#..#.##.#
#..####.#
#####..#.
#..#.#.#.
#####...#
.##..#...

##.##.##.##
.#.##.##.##
..#.##..##.
###....#..#
#..#.###...
#..#.###...
###....#..#

##.##..
.#.....
##.##..
..##.##
####...
..#.##.
..##.#.
###....
....##.
##.###.
##.###.

#.##.#....#
#.##.#....#
######.##..
.##.###.##.
.##..##.#..
######..##.
#.##..#.#.#
.#.##..#..#
.##########
.##########
.#.##..#..#
#.###.#.#.#
######..##.
.##..##.#..
.##.###.##.
######.##..
#.##.#....#'''[1:]

sections = rawInput.split('\n\n')

def checkReflection(grid, row, col, maxMistakes = 0, mistakes = 0):
    # col is to the right of reflection line
    maxJ = min(col - 1, len(grid[0]) - 1 - col)
    for j in range(maxJ + 1):
        l = grid[row][col - 1 - j]
        r = grid[row][col + j]

        if l != r:
            mistakes += 1
            if mistakes > maxMistakes:
                return False

    if row == len(grid) - 1:
        return mistakes == maxMistakes
    else:
        return checkReflection(grid, row + 1, col, maxMistakes, mistakes)

def getReflectionIndex(grid):
    for col in range(1, len(grid[0])):
        if checkReflection(grid, 0, col):
            return col

    return None

def getSmudgeReflectionIndex(grid):
    normalIndex = getReflectionIndex(grid)

    for col in range(1, len(grid[0])):
        if col != normalIndex and checkReflection(grid, 0, col, 1):
            return col

total = 0
for section in sections:
    grid = section.split('\n')
    smudgeIndex = getSmudgeReflectionIndex(grid)

    if smudgeIndex is None:
        smudgeIndex = getSmudgeReflectionIndex(flipGrid(grid))
        total += 100 * smudgeIndex
    else:
        total += smudgeIndex

print(total)